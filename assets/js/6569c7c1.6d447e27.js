"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8637],{5429:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var t=s(5893),n=s(1151);const i={title:"@grpc"},o=void 0,a={id:"operators/grpc",title:"@grpc",description:"The @grpc directive enables the resolution of GraphQL fields via gRPC services. Below is an illustrative example of how to apply this directive within a GraphQL schema:",source:"@site/docs/operators/grpc.md",sourceDirName:"operators",slug:"/operators/grpc",permalink:"/docs/operators/grpc",draft:!1,unlisted:!1,editUrl:"https://github.com/tailcallhq/tailcallhq.github.io/tree/develop/docs/operators/grpc.md",tags:[],version:"current",frontMatter:{title:"@grpc"},sidebar:"tutorialSidebar",previous:{title:"@graphQL",permalink:"/docs/operators/graphql"},next:{title:"@http",permalink:"/docs/operators/http"}},c={},d=[{value:"Understanding the Proto File Structure",id:"understanding-the-proto-file-structure",level:2},{value:"Directive Parameters",id:"directive-parameters",level:3},{value:"<code>method</code>",id:"method",level:4},{value:"<code>baseURL</code>",id:"baseurl",level:4},{value:"<code>body</code>",id:"body",level:4},{value:"<code>headers</code>",id:"headers",level:4},{value:"<code>groupBy</code>",id:"groupby",level:4}];function l(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,n.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:"@grpc"})," directive enables the resolution of GraphQL fields via gRPC services. Below is an illustrative example of how to apply this directive within a GraphQL schema:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'schema @link(src: "./users.proto", type: Protobuf) {\n  query: Query\n}\n\ntype Query {\n  users: [User] @grpc(method: "users.UserService.ListUsers")\n}\n'})}),"\n",(0,t.jsxs)(r.p,{children:["This schema snippet demonstrates the directive's application, where a query for ",(0,t.jsx)(r.code,{children:"users"})," triggers a gRPC request to the ",(0,t.jsx)(r.code,{children:"UserService"}),"'s ",(0,t.jsx)(r.code,{children:"ListUsers"})," method, thereby fetching the user data."]}),"\n",(0,t.jsx)(r.h2,{id:"understanding-the-proto-file-structure",children:"Understanding the Proto File Structure"}),"\n",(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:".proto"})," file delineates the structure and methods of the gRPC service. A simplified example of such a file is as follows:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage users;\n\nservice UserService {\n  rpc ListUsers (UserListRequest) returns (UserListReply) {}\n  rpc GetUser (UserGetRequest) returns (UserGetReply) {}\n}\n\nmessage UserListRequest {\n  // Definitions of request parameters\n}\n\nmessage UserListReply {\n  // Structure of the reply\n}\n\nmessage UserGetRequest {\n  // Definitions of request parameters\n}\n\nmessage UserGetReply {\n  // Structure of the reply\n}\n'})}),"\n",(0,t.jsx)(r.admonition,{type:"important",children:(0,t.jsx)(r.p,{children:"It is mandatory to have a package name in a protobuf file."})}),"\n",(0,t.jsxs)(r.p,{children:["Linking this file within a GraphQL schema is facilitated by the ",(0,t.jsx)(r.code,{children:"@link"})," directive, as shown below:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'schema @link(src: "./users.proto", type: Protobuf) {\n  query: Query\n}\n'})}),"\n",(0,t.jsxs)(r.p,{children:["Tailcall automatically resolves the protobuf file for any methods referenced in the ",(0,t.jsx)(r.code,{children:"@grpc"})," directive."]}),"\n",(0,t.jsx)(r.h3,{id:"directive-parameters",children:"Directive Parameters"}),"\n",(0,t.jsx)(r.h4,{id:"method",children:(0,t.jsx)(r.code,{children:"method"})}),"\n",(0,t.jsxs)(r.p,{children:["This parameter specifies the gRPC service and method to be invoked, formatted as ",(0,t.jsx)(r.code,{children:"<package>.<service>.<method>"}),":"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'type Query {\n  users: [User] @grpc(method: "proto.users.UserService.ListUsers")\n}\n'})}),"\n",(0,t.jsx)(r.h4,{id:"baseurl",children:(0,t.jsx)(r.code,{children:"baseURL"})}),"\n",(0,t.jsxs)(r.p,{children:["Defines the base URL for the gRPC API. If not specified, the URL set in the ",(0,t.jsx)(r.code,{children:"@upstream"})," directive is used by default:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'type Query {\n  users: [User] @grpc(baseURL: "https://grpc-server.example.com", method: "proto.users.UserService.ListUsers")\n}\n'})}),"\n",(0,t.jsx)(r.h4,{id:"body",children:(0,t.jsx)(r.code,{children:"body"})}),"\n",(0,t.jsx)(r.p,{children:"This parameter outlines the arguments for the gRPC call, allowing for both static and dynamic inputs:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'type UserInput {\n  id: ID\n}\n\ntype Query {\n  user(id: UserInput!): User @grpc(body: "{{args.id}}", method: "proto.users.UserService.GetUser")\n}\n'})}),"\n",(0,t.jsx)(r.h4,{id:"headers",children:(0,t.jsx)(r.code,{children:"headers"})}),"\n",(0,t.jsx)(r.p,{children:"Custom headers for the gRPC request can be defined, facilitating the transmission of authentication tokens or other contextual data:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'type Query {\n  users: [User]\n    @grpc(headers: [{key: "X-CUSTOM-HEADER", value: "custom-value"}], method: "proto.users.UserService.ListUsers")\n}\n'})}),"\n",(0,t.jsx)(r.h4,{id:"groupby",children:(0,t.jsx)(r.code,{children:"groupBy"})}),"\n",(0,t.jsx)(r.p,{children:"This argument is employed to optimize batch requests by grouping them based on specified response keys, enhancing performance in scenarios requiring multiple, similar requests:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-graphql",children:'type Query {\n  users(id: UserInput!): [User]\n    @grpc(groupBy: ["id"], method: "proto.users.UserService.ListUsers", baseURL: "https://grpc-server.example.com")\n}\n'})}),"\n",(0,t.jsx)(r.admonition,{type:"info",children:(0,t.jsxs)(r.p,{children:["Read about ",(0,t.jsx)(r.strong,{children:(0,t.jsx)(r.a,{href:"/docs/guides/n+1/",children:"n + 1"})})," to learn how to use the ",(0,t.jsx)(r.code,{children:"groupBy"})," setting."]})})]})}function h(e={}){const{wrapper:r}={...(0,n.a)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,r,s)=>{s.d(r,{Z:()=>a,a:()=>o});var t=s(7294);const n={},i=t.createContext(n);function o(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);