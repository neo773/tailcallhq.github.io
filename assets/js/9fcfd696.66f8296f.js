"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5091],{5704:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var s=n(5893),i=n(1151);const r={title:"@cache"},a=void 0,c={id:"operators/cache",title:"@cache",description:"The @cache directive provides a protocol agnostic mechanism for caching the results of fields within a GraphQL schema. Like any other cache implementation this feature is useful for optimizing performance by reducing the need to repeatedly fetch data that doesn't change frequently.",source:"@site/docs/operators/cache.md",sourceDirName:"operators",slug:"/operators/cache",permalink:"/docs/operators/cache",draft:!1,unlisted:!1,editUrl:"https://github.com/tailcallhq/tailcallhq.github.io/tree/develop/docs/operators/cache.md",tags:[],version:"current",frontMatter:{title:"@cache"},sidebar:"tutorialSidebar",previous:{title:"@addField",permalink:"/docs/operators/add-field"},next:{title:"@const",permalink:"/docs/operators/const"}},h={},o=[{value:"maxAge",id:"maxage",level:2},{value:"Usage",id:"usage",level:2},{value:"Cache Key",id:"cache-key",level:2}];function l(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"@cache"})," directive provides a protocol agnostic mechanism for caching the results of fields within a GraphQL schema. Like any other cache implementation this feature is useful for optimizing performance by reducing the need to repeatedly fetch data that doesn't change frequently."]}),"\n",(0,s.jsx)(t.h2,{id:"maxage",children:"maxAge"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:"@cache(maxAge: Int)\n"})}),"\n",(0,s.jsx)(t.p,{children:"This parameter is a non-zero unsigned integer that specifies the duration, in milliseconds, for which the cached value should be retained."}),"\n",(0,s.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(t.p,{children:"Consider the following GraphQL schema example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int\n  title: String\n  userId: Int @cache(maxAge: 100)\n  user: User @http(path: "/user/{{value.userId}}") @cache(maxAge: 200)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["In this configuration, the result of the ",(0,s.jsx)(t.code,{children:"user"})," field will be cached because it is associated with an HTTP resolver. However, the values of ",(0,s.jsx)(t.code,{children:"userId"})," and ",(0,s.jsx)(t.code,{children:"title"})," will not be cached as they do not have their own resolvers; their values are retrieved by the resolver at the ",(0,s.jsx)(t.code,{children:"posts"})," field, which utilizes the ",(0,s.jsx)(t.code,{children:'@http(path: "/posts")'})," directive."]}),"\n",(0,s.jsxs)(t.p,{children:["Applying the ",(0,s.jsx)(t.code,{children:"@cache"})," directive at the type level affects all fields within that type. For example:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post @cache(maxAge: 100) {\n  id: Int\n  title: String\n  userId: Int\n  user: User @http(path: "/user/{{value.userId}}")\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["This configuration can be reduced as follows, demonstrating that the ",(0,s.jsx)(t.code,{children:"@cache"})," directive, when applied to a type, is inherited by each field within that type:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int @cache(maxAge: 100)\n  title: String @cache(maxAge: 100)\n  userId: Int @cache(maxAge: 100)\n  user: User @http(path: "/user/{{value.userId}}") @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["However, since the ",(0,s.jsx)(t.code,{children:"@cache"})," directive does not affect fields without resolvers, the effective configuration can be further reduced to follows:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post {\n  id: Int\n  title: String\n  userId: Int\n  user: User @http(path: "/user/{{value.userId}}") @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["When the ",(0,s.jsx)(t.code,{children:"@cache"})," directive is applied both at the type level and on individual fields within that type, the field-level directive takes precedence:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-graphql",children:'type Query {\n  posts: [Post] @http(path: "/posts")\n}\n\ntype Post @cache(maxAge: 200) {\n  id: Int\n  title: String\n  userId: Int\n  user: User @http(path: "/user/{{value.userId}}") @cache(maxAge: 100)\n}\n\ntype User {\n  id: Int\n  name: String\n  email: String\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Thus, in the configuration above, while the ",(0,s.jsx)(t.code,{children:"@cache(maxAge: 200)"})," directive at the type level is inherited by all fields, the ",(0,s.jsx)(t.code,{children:"user"})," field's explicit ",(0,s.jsx)(t.code,{children:"@cache(maxAge: 100)"})," directive takes precedence."]}),"\n",(0,s.jsx)(t.h2,{id:"cache-key",children:"Cache Key"}),"\n",(0,s.jsx)(t.p,{children:"The caching mechanism generates a hash based on information related to the applied query to serve as the cache key for the corresponding value."}),"\n",(0,s.jsxs)(t.p,{children:["For instance, the ",(0,s.jsx)(t.code,{children:"user"})," field in the following configuration will be cached, with the cache key being the hash of the interpolated string ",(0,s.jsx)(t.code,{children:'"/user/{{value.userId}}"'}),". For example, if ",(0,s.jsx)(t.code,{children:"Post.userId"})," equals ",(0,s.jsx)(t.code,{children:"1"}),", the cache key will be the hash of the string ",(0,s.jsx)(t.code,{children:'"/users/1"'}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},1151:(e,t,n)=>{n.d(t,{Z:()=>c,a:()=>a});var s=n(7294);const i={},r=s.createContext(i);function a(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);